WITH YDC AS
 (SELECT R.WJDC, COUNT(*) COU FROM SQMY_WJDCRE R GROUP BY R.WJDC)
SELECT * FROM ( 
 SELECT t.* ,ROWNUM AS rn FROM (
SELECT * 
  FROM SQMY_WJDC W
  LEFT JOIN YDC Y
    ON W.WJDC = Y.WJDC
 WHERE 1 = 1 
 ORDER BY W.WJDC DESC  )t WHERE ROWNUM <10) WHERE rn>3
